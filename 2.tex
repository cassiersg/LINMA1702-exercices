\section{Formes canoniques}
\label{ape:cheby_center}


{\bf Forme géométrique}

$$
\begin{array}{ll}
  \mini &  c^T x \\
  \mbox{ }
  & A x \geq b
\end{array}
$$


{\bf Forme standard}

$$
\begin{array}{lrcr}
  \mini &  c^T x \\
  \mbox{ }
  & A x & = &  b\\
  & x & \geq & 0
\end{array}
$$
\\



\newpage



\begin{enumerate}


  \item Ecrivez  le programme linéaire suivant sous forme géométrique

    $
    \begin{array}{lrcr}
      \maxi & -x_1 + 8 x_2 \\
      & x_1 + x_2 & = & 1\\
      & x_1 + 2x_2 & \leq & 3\\
      & x_1 & \geq & 0
    \end{array}
    $

    \begin{solution}
      \begin{align*}
        -\min x_{1}-8x_{2}\\
        x_{1} + x_{2} & \geq 1\\
        -x_{1} - x_{2} & \geq -1\\
        -x_{1} - 2x_{2} & \geq -3\\
        x_{1} & \geq 0.
      \end{align*}
    \end{solution}


  \item Ecrivez  le programme linéaire suivant sous forme standard

    $
    \begin{array}{lrcr}
      \mini & -x_1 + 8 x_2 \\
      & x_1 + x_2 & \geq & 1\\
      & x_1 + 2x_2 & \leq & 3\\
      & x_1 & \geq & 0
    \end{array}
    $

    \begin{solution}
      \begin{align*}
        \min -x_{1} + 8(x_{2}^{+} - x_{2}^{-})\\
        x_{1} + x_{2}^{+} - x_{2}^{-} - x_{3} = 1\\
        x_{1} + 2(x_{2}^{+} - x_{2}^{-}) + x_{4} = 3\\
        x_{1},x_{2}^{+},x_{2}^{-},x_{3}, x_{4} \geq 0.
    \end{align*}
    \end{solution}


  \item Ecrivez  le programme linéaire suivant sous forme standard

    $
    \begin{array}{lrcr}
      \mini & x_1-5x_2-7x_3\\
      & 5x_1-2x_2+6x_3  & \geq & 5\\
      &3x_1+4x_2-9x_3 & = & 3\\
      &7x_1+3x_2+ 5x_3 & \leq & 9\\
      & x_1  & \geq & -2\\
    \end{array}
    $

    \begin{solution}
      Pour éviter de créer trop de variables changeons simplement $x_1$
      en $\tilde{x}_1 - 2$.
      \begin{align*}
        \min \tilde{x}_{1} - 5(x_{2}^{+} - x_{2}^{-})
        -7(x_{3}^{+} - x_{3}^{-})\\
        5\tilde{x}_{1} - 2(x_{2}^{+} - x_{2}^{-})
        +6(x_{3}^{+} - x_{3}^{-}) - x_{4} & = 15\\
        3\tilde{x}_{1}+4(x_{2}^{+} - x_{2}^{-})
        -9(x_{3}^{+} - x_{3}^{-}) & = 9\\
        7\tilde{x}_{1}+3(x_{2}^{+} - x_{2}^{-})
        +5(x_{3}^{+} - x_{3}^{-}) + x_{5} & = 23\\
        \tilde{x}_{1}, x_{2}^{+}, x_{2}^{-}, x_{3}^{+},
        x_{3}^{-}, x_{4}, x_{5} & \geq 0.
      \end{align*}
    \end{solution}

  \item Soit le problème d'optimisation

    $
    \begin{array}{lrcr}
      \mini   &  2x_1+3 \; | x_2-10|\\
      & |x_1+2| + |x_2| & \leq & 5
    \end{array}
    $

    Formulez ce problème comme un problème d'optimisation linéaire.

    \begin{solution}
      On a deux possibilités.
      \begin{align*}
        \min 2x_1 + 3t\\
        x_2 - t & \leq 10\\
        -x_2 - t & \leq -10\\
        u + v & \leq 5\\
        x_1 - u & \leq -2\\
        -x_1 - u & \leq 2\\
        x_2 - v & \leq 0\\
        -x_2 - v & \leq 0
      \end{align*}
      ou
      \begin{align*}
        \min 2x_1 + 3t\\
        x_2 - t & \leq 10\\
        -x_2 - t & \leq -10\\
        x_1 + x_2 & \leq 3\\
        -x_1 - x_2 & \leq 7\\
        x_1 + x_2 & \leq 3\\
        -x_1 - x_2 & \leq 7.
      \end{align*}
      La première est plus élégante mais la seconde utilise
      moins de variables et une contraintes en plus.
    \end{solution}


  \item Un problème d'optimisation linéaire peut-il toujours s'écrire sous la forme $\min c^Tx$ sous la contrainte $Ax = b$? Si oui, démontrez, si non, justifiez.

    \begin{solution}
      Non. En effet,
      si le coût optimal est bornée, posons $z^*$ sa valeur.
      L'ensemble de solutions optimales sera l'ensemble des solutions de
      \[
        \begin{pmatrix}
          A\\c^T
        \end{pmatrix}
        x =
        \begin{pmatrix}
          b\\z^*
        \end{pmatrix}
      \]
      qui est soit un point, soit la somme entre un sous espace vectoriel
      et une solution particulière.
      Or pour un problème d'optimisation linéaire,
      on peut avoir d'autres ensembles de solutions comme une demi droite
      pour $\min 1$ avec $x \geq 0$
      qui n'est aucun de ces deux types d'ensemble.
    \end{solution}

  \item Une fusée se déplace en suivant une trajectoire rectiligne. Soit $x_t$, $v_t$
    et $a_t$ la position, la vitesse et l'accélération de la fusée au temps $t$. En discrétisant le temps et en considérant un incrément
    unité, trouvez des expressions pour $x_{t+1}$ et $v_{t+1}$ en fonction de $x_t, v_t$ et $a_t$. Nous supposons que l'accélération $a_t$ est sous notre
    contrôle. Par ailleurs, la fusée est au repos à l'origine au temps
    $t=0$ ($x_0=0$ et
    $v_0=0$). Nous désirons faire décoller la fusée pour la faire atterrir  en douceur au temps $T$ à une
    distance d'une unité de son point de départ ($x_T=1$ et $v_T=0$). De plus, nous désirons atteindre cet
    objectif en minimisant la consommation totale de carburant
    $\sum_{t=0}^{T-1} |a_t|$.  Formulez ce problème comme un problème d'optimisation linéaire.

    \begin{solution}
      En supposant $a_t$ constant sur son intervalle de temps, on a
      \[ v_{t+1} = v_t + a_t \]
      et
      \[ x_{t+1} = \int_t^{t+1} v(\tau) \dif \tau
      = \int_t^{t+1} v_t + (t-\tau)a_t \dif \tau
      = v_t + \frac{a_t}{2}. \]
      Le problème d'optimisation linéaire est donc
      \begin{align*}
        \min \sum_{t=0}^{T-1} u_t\\
        a_t & \leq u_t & t = 0,\ldots,T-1\\
        -a_t & \leq u_t & t = 0,\ldots,T-1\\
        v_{t+1} & = v_t + a_t & t = 0,\ldots,T-1\\
        x_{t+1} & = v_t + \frac{a_t}{2} & t = 0,\ldots,T-1\\
        v_0 & = 0\\
        x_0 & = 0\\
        v_T & = 0\\
        x_T & = 1.
      \end{align*}
    \end{solution}



  \item Nous considérons l'ensemble $P=\{ x \in \R^n \; | \; a_i^T x \leq b_i \; , \;  i=1, \ldots, m \}$. Nous désirons trouver la
    plus grande boule entièrement contenue dans cet ensemble. Le centre de cette boule est  le {\it centre de Chebychev} de $P$.  Formulez
    ce problème comme un problème d'optimisation linéaire. (Indication:  La distance entre l'hyperplan $\{x \in \R^n | \;  a^Tx=b \}$ et le point $x_0 \in \R^n$
    est donnée par
    $|a^Tx_0 - b|/\|a\|$ avec $\|a\|=\sqrt{a_1^2+ \ldots + a_n^2}$.)

    \label{ex:cheby_center}
    % Si l'exercice est déplacer,
    % il faut aussi déplacer \label{ape:cheby_center}.
    \begin{solution}
      \begin{align*}
        d(x, P) & = \min_i \frac{|a_i^Tx - b_i|}{\|a_i\|}\\
        \max_{x\in P} d(x, P)
        & = \max_{x\in P}\min_i \frac{|a_i^Tx - b_i|}{\|a_i\|}.
      \end{align*}
      On a donc
      \begin{align*}
        \max_{x, t} t\\
        |a_i^Tx - b_i| & \geq t\|a_i\| & \forall i\\
        a_i^Tx & \leq b_i & \forall i
      \end{align*}
      ou encore, comme $a_i^Tx \leq b_i \leq 0$,
      \begin{align*}
        \max_{x, t} t\\
        a_i^Tx + \|a_i\|t & \leq b_i & \forall i\\
        a_i^Tx & \leq b_i & \forall i
      \end{align*}
      qui peut encore s'écrire
      \begin{align*}
        \max_{x, t} t\\
        a_i^Tx + \|a_i\|t & \leq b_i & \forall i\\
        t & \geq 0.
      \end{align*}
    \end{solution}


  \item Nous considérons un ensemble de $m$ lampes disposées aux points $l_1, \ldots, l_m \in \R^2$ du plan et éclairant $n$
    tronçons. Les tronçons sont des segments de droites. Le tronçon $i$ est donné par $[v_i, v_{i+1}]$ où $v_1, \ldots, v_{n+1}
    \in \R^2$.  Les variables du problème sont les puissances des lampes $p_1, \ldots, p_m$, qui peuvent varier entre 0 et 1.
    L'illumination $I_i$ du point milieu du tronçon $i$ dépend de la position des lampes et de leurs
    puissances. Nous utilisons un modèle simple d'illumination

    $$I_i = \sum_{j=1}^m a_{ij} p_j, \qquad a_{ij}=r_{ij}^{-2} \max \{\cos \theta_{ij}, 0 \}$$

    où $r_{ij}$ représente la distance entre la lampe $j$ et le point milieu du tronçon $i$, et $\theta_{ij}$ représente l'angle
    entre la normale du tronçon $i$ et le segment de droite qui lie le point milieu du tronçon $i$ et la lampe $j$ (voir Figure). Ce
    modèle rend compte du fait qu'un tronçon n'est illuminé que par les lampes situées dans le demi-plan qui lui fait face,
    mais ne prend pas en compte l'illumination des tronçons entre eux par réflexion.  Le problème consiste à déterminer la puissance des lampes de façon à ce
    que les niveaux d'illumination des  tronçons soient tous proches du niveau désiré $I_{des}$. Nous choisissons la déviation maximum

    $$\max_{i=1, \ldots, n} | I_i -I_{des}|$$

    pour quantifier la déviation globale par rapport au niveau d'illumination désiré. Formulez ce problème comme un problème d'optimisation linéaire.

    \begin{solution}
      Il faut minimiser la norme $l^{\infty}$ puisqu'il s'agit de quantifier la déviation \textit{globale} 
      $$ \max \mid I_{i} - I_{des} \mid $$ 
      Le problème d'optimisation linéaire peut s'écrire sous la forme : 
      \begin{align*}
        \min t\\
        \sum_{j}a_{ij}p_{j} - t & \leq I_{des} & i = 1, 2, \dots, m\\
        -\sum_{j}a_{ij}p_{j} - t & \leq -I_{des} & i = 1, 2, \dots, m\\
        p_j & \leq 1\\
        p_j & \geq 0.
      \end{align*}
    \end{solution}



  \item Les résultats finaux $x_i$ pour l'examen INMA2702 sont les suivants (par ordre croissant, résultats sur 100): 28, 62, 80,
    83, 86, 87,  92, 95, 98. On cherche à exprimer au moyen d'un seul nombre la manière dont l'examen a été réussi. La moyenne des résultats
    est de
    $\overline x = \sum_i x_i /9 = 79$. Un étudiant ayant
    obtenu 80 fait donc mieux que la moyenne des résultats. Il fait toutefois moins bien que plus de la moitié des étudiants. La
    \emph{médiane}  des résultats est un résultat qui partage l'ensemble des résultats en deux ensembles de  tailles égales. Dans notre
    exemple, la médiane est donnée par $86$. Montrez que la moyenne et la médiane s'obtiennent comme solutions optimales des problèmes
    d'optimisation
    $$\min_x \sum_i (x-x_i)^2$$
    et
    $$\min_x \sum_i |x-x_i|.$$
    Quelle est la solution du problème
    $$\min_x \max_i | x-x_i| ?$$

    \begin{solution}
      \begin{enumerate}
        \item
          Soit $f = \sum_{i=1}^{n}(x-x_{i})^{2}$.
          En annulant la dérivée, on obtient
          \begin{align*}
            2\sum_{i=1}^{n}(x-x_{i}) & = 0\\
            nx & = \sum_{i=1}^{n} x_{i}\\
            x & = \frac{1}{n}\sum_{i=1}^{n} x_{i}.
          \end{align*}
        \item
          Soit $f(x) = \sum_{i=1}^{n} |x-x_{i}| = \sum_{x \geq x_{i}}
          (x-x_{i}) - \sum_{x < x_{i}} (x-x_{i})$.
          En annulant la dérivée, on obtient
          \[ \sum_{x \geq x_i}^n 1 = \sum_{x < x_i} 1. \]
          Ce n'est pas extrêmement rigoureux car lorsque
          $x = x_i$, ce n'est pas dérivable mais l'idée est là.
          Lorsqu'il y a plus de $x_i$ à gauche de $x$ qu'à droite,
          $f'(x) > 0$ et
          lorsqu'il y a moins de $x_i$ à gauche de $x$ qu'à droite,
          $f'(x) < 0$.
        \item
          \[ \xopt = \frac{\min_i x_i + \max_i x_i}{2}. \]
      \end{enumerate}
    \end{solution}



  \item  Soit $\{b_1, b_2, \ldots, b_m\}$ un ensemble de points du plan. Le \emph{centro\"ide}
    $$\overline x = \frac{1}{m} \sum_i b_i$$
    minimise la somme des carrés des distances aux points de l'ensemble. Comment trouver le point qui minimise la somme des distances (et
    non pas la somme des carrés)? Trouvez une description explicite de ce point pour les cas $m=2$ et $m=3$.

    \begin{solution}
      Il suffit de résoudre le problème d'optimisation linéaire
      \begin{align*}
        \min \sum_i t_i\\
        x - t_i & \leq b_i\\
        -x - t_i & \leq -b_i.
      \end{align*}
      Pour $m = 2$, c'est le milieur de $b_1$ et $b_2$.
      Pour $m = 3$, c'est l'isobarycentre de $b_1$, $b_2$ et $b_3$.
      Aussi appelé centre de gravité du triangle.
      C'est aussi l'intersection des médianes.
    \end{solution}




  \item  Les composants d'une puce électronique sont placés sur
    une puce carrée $\{ (x, y) \; |  -1 \leq x, y \leq 1\}$.
    Chaque composant possède plusieurs bornes qui sont connectées à
    des bornes d'autres composants, ou aux bornes d'entrée/\-sortie situées sur le périmètre de la puce.  Les connexions et les
    positions des bornes d'entrée/sortie sont fixées; les seules variables sont les coordonnées   $(x_i, y_i)$ des $n$
    composants.  Les connexions entre les composants
    sont précisés de la manière suivante. On définit les vecteurs


    $$x=
    \left(
    \begin{array}{c}
      x_1\\
      \vdots\\
      x_n
    \end{array}
    \right)
    \mbox{ et }
    y=
    \left(
    \begin{array}{c}
      y_1\\
      \vdots\\
      y_n
    \end{array}
    \right)
    $$



    et on construit une matrice $A \in \R^{m \times n}$ et deux vecteurs $b_x \in \R^m, b_y \in \R^m$.
    Chaque ligne de
    $A$ et chaque entrée de $b_x$ et de $b_y$ décrivent une connexion. Pour chaque $i=1, \ldots, m$, nous pouvons distinguer deux cas
    suivant que la ligne $i$ de $A$ décrit une connexion entre deux composants, ou entre un composant et une borne d'entrée/sortie.
    \begin{itemize}
      \item Si $i$ décrit une connexion entre deux composants $j$ et $k$ (avec $j < k$), alors

        $$a_{il}=
        \left\{
          \begin{array}{rl}
            1 & \mbox{si } l=j\\
            -1 & \mbox{si } l=k\\
            0 & \mbox{sinon}
          \end{array}
        \right.
        \mbox{ et }
        b_{x, i}=0, b_{y,i}=0
        $$

        et nous avons  $a_i^Tx-b_{x,i}=x_j-x_k$ et $a_i^Ty-b_{y,i}=y_j-y_k.$

      \item Si $i$ décrit une connexion entre un composant $j$ et une borne d'entrée/sortie de coordonnée $(\bar x, \bar y)$, alors

        $$a_{il}=
        \left\{
          \begin{array}{rll}
            1 & \mbox{si } l=j\\
            0 & \mbox{sinon}
          \end{array}
        \right.
        \mbox{ et }
        b_{x, i}=\bar x, b_{y,i}=\bar y
        $$

        et nous avons $a_i^Tx-b_{x,i}=x_j-\bar x$ et $a_i^Ty-b_{y,i}=y_j-\bar y.$

    \end{itemize}

    Le problème consiste à déterminer les coordonnées des composants qui minimisent
    la plus grande distance de Manhattan
    entre deux composants connectés, ou entre un composant et une borne. (Remarque: La distance de Manhattan entre les
    points de coordonnées
    $(x_0, y_0)$ et
    $(x_1, y_1)$ est donnée par
    $|x_1-x_0|+|y_1-y_0|$.) Formulez ce problème sous la forme d'un problème
    d'optimisation. En utilisant la propriété
    $|a|+|b|=\max(a+b, a-b, -a+b, -a-b)$, formulez le problème sous la
    forme d'un problème d'optimisation linéaire.

    \begin{solution}
      \nosolution
    \end{solution}

\end{enumerate}
